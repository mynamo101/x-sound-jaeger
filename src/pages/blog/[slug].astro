---
// src/pages/blog/[slug].astro
import Layout from '../../layouts/Layout.astro';

export async function getStaticPaths() {
  // 生成 URL 友好的 slug
  function generateSlug(title: string): string {
    return title
      .toLowerCase()
      .replace(/[^a-z0-9]+/g, '-')
      .replace(/(^-|-$)/g, '');
  }

  // 所有文章数据（与首页保持一致）
  const allPosts = [
    { title: 'Maximizing Work Productivity', date: '2025-03-27', tag: 'Business', summary: 'Tincidunt sit id maecenas vitae felis. Volutpat porta lectus malesuada ornare suspendisse eu vestibulum massa. Id etiam in molestie cras bibendum.' },
    { title: 'The Ultimate Adventure Guide', date: '2025-03-26', tag: 'Lifestyle', summary: 'Phasellus sollicitudin ut pellentesque vitae eleifend diam rutrum elementum libero. Mauris nulla sollicitudin massa donec ac interdum sagittis egestas.' },
    { title: 'Power of Artificial Intelligence', date: '2025-03-24', tag: 'Business', summary: 'Lectus suspendisse eleifend nunc vulputate aliquam sit. Venenatis ac mattis vel ultricies platea mauris. Dignissim malesuada pharetra ut quis ornare sollicitudin feugiat amet vitae.' },
    { title: 'Traveling on a Budget', date: '2025-03-10', tag: 'Travel', summary: 'Pretium urna viverra ipsum diam lacus nunc a lobortis. Quis lectus nisi tristique mi sit purus sed nunc. Quam ridiculus aliquet in vulputate euismod fusce nisl vel.' },
    { title: 'Unleash Your Creative Potential', date: '2025-03-31', tag: 'Creative', summary: 'Nec sed pharetra scelerisque blandit. Vitae commodo integer nibh etiam. Iaculis nunc dui interdum donec sodales. Curabitur eget tincidunt amet et nunc. Amet id faucibus ipsum vitae.' },
    { title: 'Uncovering Hidden & Special Places', date: '2025-03-30', tag: 'Travel', summary: 'Tristique hendrerit massa adipiscing tincidunt sed. Ultrices vitae vel maecenas tincidunt semper neque auctor porttitor quis. Turpis et malesuada metus malesuada eu integer eleifend.' },
    { title: 'Exploring the Creative Boundaries', date: '2025-03-29', tag: 'Creative', summary: 'Lectus suspendisse eleifend nunc vulputate aliquam sit. Venenatis ac mattis vel ultricies platea mauris. Dignissim malesuada pharetra ut quis ornare sollicitudin feugiat amet vitae.' },
    { title: 'Unlocking Creativity of Design', date: '2025-03-28', tag: 'Design', summary: 'Mi eu mauris vitae euismod ligula sed. Amet sed pellentesque vulputate sed. Velit donec libero eget libero malesuada lacus vel venenatis.' }
  ];

  return allPosts.map(post => ({
    params: { slug: generateSlug(post.title) },
    props: { post, allPosts, generateSlug } // 将 generateSlug 也传递给 props
  }));
}

const { slug } = Astro.params;
const { post, allPosts: postsData, generateSlug } = Astro.props;

// 格式化日期
const formattedDate = new Date(post.date).toLocaleDateString('en-US', {
  year: 'numeric',
  month: 'long',
  day: 'numeric'
});

// 相关文章（同标签的其他文章）
const relatedPosts = postsData
  .filter(p => p.tag === post.tag && generateSlug(p.title) !== slug)
  .slice(0, 3);
---

<Layout>
  <!-- 导航栏 -->
  <nav class="navbar">
    <div class="nav-container">
      <a href="/" class="logo-link">
        <h1 class="logo">Elysian</h1>
      </a>
      <div class="nav-links">
        <a href="/archive">Archive</a>
        <a href="/tags">Tags</a>
        <a href="/authors">Authors</a>
        <a href="/about">About</a>
      </div>
    </div>
  </nav>

  <main class="main-content article-page">
    <!-- Article Header -->
    <header class="article-header">
      <div class="article-header-content">
        <div class="article-meta">
          <span class="article-tag">{post.tag.toUpperCase()}</span>
          <span class="article-date">{formattedDate}</span>
        </div>
        <h1 class="article-title">{post.title}</h1>
        <p class="article-summary">{post.summary}</p>
      </div>
    </header>

    <!-- Article Content -->
    <article class="article-content">
      <div class="article-container">
        <!-- Article Body -->
        <div class="article-body">
          <div class="article-image">
            <img src="https://images.unsplash.com/photo-1499750310107-5fef28a66643?w=1200&h=600&fit=crop" alt={post.title} />
          </div>
          
          <div class="content-text">
            <p>
              Lorem ipsum dolor sit amet, consectetur adipiscing elit. Sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. 
              Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure 
              dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur.
            </p>
            
            <h2>Introduction</h2>
            <p>
              Sed ut perspiciatis unde omnis iste natus error sit voluptatem accusantium doloremque laudantium, totam rem aperiam, 
              eaque ipsa quae ab illo inventore veritatis et quasi architecto beatae vitae dicta sunt explicabo. Nemo enim ipsam 
              voluptatem quia voluptas sit aspernatur aut odit aut fugit, sed quia consequuntur magni dolores eos qui ratione 
              voluptatem sequi nesciunt.
            </p>
            
            <h2>Key Points</h2>
            <ul>
              <li>Understanding the fundamentals of {post.tag.toLowerCase()} strategies</li>
              <li>Implementing practical solutions for real-world scenarios</li>
              <li>Measuring success and optimizing for better results</li>
              <li>Common pitfalls to avoid and best practices to follow</li>
            </ul>
            
            <h2>Deep Dive</h2>
            <p>
              At vero eos et accusamus et iusto odio dignissimos ducimus qui blanditiis praesentium voluptatum deleniti atque 
              corrupti quos dolores et quas molestias excepturi sint occaecati cupiditate non provident, similique sunt in culpa 
              qui officia deserunt mollitia animi, id est laborum et dolorum fuga.
            </p>
            
            <blockquote>
              "The key to success in {post.tag.toLowerCase()} is understanding that every challenge is an opportunity 
              for growth and innovation."
            </blockquote>
            
            <p>
              Et harum quidem rerum facilis est et expedita distinctio. Nam libero tempore, cum soluta nobis est eligendi 
              optio cumque nihil impedit quo minus id quod maxime placeat facere possimus, omnis voluptas assumenda est, 
              omnis dolor repellendus.
            </p>
            
            <h2>Conclusion</h2>
            <p>
              Temporibus autem quibusdam et aut officiis debitis aut rerum necessitatibus saepe eveniet ut et voluptates 
              repudiandae sint et molestiae non recusandae. Itaque earum rerum hic tenetur a sapiente delectus, ut aut 
              reiciendis voluptatibus maiores alias consequatur aut perferendis doloribus asperiores repellat.
            </p>
          </div>
        </div>

        <!-- Sidebar -->
        <aside class="article-sidebar">
          <div class="sidebar-widget">
            <h3>Table of Contents</h3>
            <ul class="toc-list">
              <li><a href="#introduction">Introduction</a></li>
              <li><a href="#key-points">Key Points</a></li>
              <li><a href="#deep-dive">Deep Dive</a></li>
              <li><a href="#conclusion">Conclusion</a></li>
            </ul>
          </div>
          
          <div class="sidebar-widget">
            <h3>Share Article</h3>
            <div class="share-buttons">
              <a href="#" class="share-button twitter">Twitter</a>
              <a href="#" class="share-button linkedin">LinkedIn</a>
              <a href="#" class="share-button facebook">Facebook</a>
            </div>
          </div>
        </aside>
      </div>
    </article>

    <!-- Related Articles -->
    {relatedPosts.length > 0 && (
      <section class="related-articles">
        <div class="related-container">
          <h2 class="related-title">Related Articles</h2>
          <div class="related-grid">
            {relatedPosts.map(relatedPost => (
              <article class="related-card">
                <div class="related-image">
                  <a href={`/blog/${generateSlug(relatedPost.title)}`}>
                    <img src="https://images.unsplash.com/photo-1499750310107-5fef28a66643?w=400&h=250&fit=crop" alt={relatedPost.title} loading="lazy" />
                  </a>
                </div>
                <div class="related-content">
                  <div class="related-meta">
                    <span class="related-tag">{relatedPost.tag}</span>
                    <span class="related-date">{new Date(relatedPost.date).toLocaleDateString('en-US', { month: 'short', day: 'numeric' })}</span>
                  </div>
                  <h3 class="related-post-title">
                    <a href={`/blog/${generateSlug(relatedPost.title)}`}>{relatedPost.title}</a>
                  </h3>
                  <p class="related-summary">{relatedPost.summary.substring(0, 80)}...</p>
                </div>
              </article>
            ))}
          </div>
        </div>
      </section>
    )}

    <!-- Navigation -->
    <section class="article-navigation">
      <div class="nav-container">
        <a href="/" class="nav-button back-home">
          ← Back to Home
        </a>
        <a href="/archive" class="nav-button view-all">
          View All Articles →
        </a>
      </div>
    </section>
  </main>

  <!-- Footer -->
  <footer class="footer">
    <div class="footer-container">
      <div class="footer-content">
        <div class="footer-brand">
          <h3>Elysian</h3>
          <p>Exploring the intersection of technology, creativity, and human experience.</p>
        </div>
        <div class="footer-links">
          <div class="link-group">
            <h4>Content</h4>
            <a href="/archive">Archive</a>
            <a href="/tags">Tags</a>
            <a href="/authors">Authors</a>
          </div>
          <div class="link-group">
            <h4>Company</h4>
            <a href="/about">About</a>
            <a href="#" class="footer-link">Privacy</a>
            <a href="#" class="footer-link">Terms</a>
          </div>
          <div class="link-group">
            <h4>Connect</h4>
            <a href="#" class="footer-link">Twitter</a>
            <a href="#" class="footer-link">LinkedIn</a>
            <a href="#" class="footer-link">RSS</a>
          </div>
        </div>
      </div>
      <div class="footer-bottom">
        <p>&copy; 2025 Elysian. All rights reserved.</p>
      </div>
    </div>
  </footer>
</Layout>

<style>
  /* Navigation Styles */
  .navbar {
    position: fixed;
    top: 0;
    width: 100%;
    background-color: rgba(26, 26, 26, 0.95);
    backdrop-filter: blur(10px);
    border-bottom: 1px solid #333;
    z-index: 1000;
    padding: 1rem 0;
  }

  .nav-container {
    max-width: 1200px;
    margin: 0 auto;
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 0 2rem;
  }

  .logo-link {
    text-decoration: none;
  }

  .logo {
    color: #fff;
    font-size: 1.8rem;
    font-weight: 700;
    margin: 0;
  }

  .nav-links {
    display: flex;
    gap: 2rem;
  }

  .nav-links a {
    color: #e0e0e0;
    text-decoration: none;
    font-weight: 500;
    transition: color 0.3s ease;
  }

  .nav-links a:hover {
    color: #3b82f6;
  }

  /* Main Content */
  .main-content {
    margin-top: 80px;
    color: #e0e0e0;
  }

  /* Article Header */
  .article-header {
    background: linear-gradient(135deg, #1a1a1a 0%, #2d2d2d 100%);
    padding: 4rem 2rem 3rem;
    text-align: center;
    border-bottom: 1px solid #333;
  }

  .article-header-content {
    max-width: 800px;
    margin: 0 auto;
  }

  .article-meta {
    display: flex;
    justify-content: center;
    align-items: center;
    gap: 1rem;
    margin-bottom: 2rem;
    font-size: 0.9rem;
  }

  .article-tag {
    background-color: #3b82f6;
    color: white;
    padding: 0.5rem 1rem;
    border-radius: 20px;
    font-weight: 600;
  }

  .article-date {
    color: #888;
  }

  .article-title {
    font-size: 3rem;
    font-weight: 700;
    margin-bottom: 1.5rem;
    line-height: 1.2;
    color: #fff;
  }

  .article-summary {
    font-size: 1.25rem;
    color: #b0b0b0;
    line-height: 1.6;
    max-width: 600px;
    margin: 0 auto;
  }

  /* Article Content */
  .article-content {
    background-color: #0d0d0d;
    padding: 3rem 2rem;
  }

  .article-container {
    max-width: 1200px;
    margin: 0 auto;
    display: grid;
    grid-template-columns: 2fr 1fr;
    gap: 4rem;
  }

  .article-body {
    background-color: #1a1a1a;
    padding: 3rem;
    border-radius: 12px;
    border: 1px solid #333;
  }

  .article-image {
    margin-bottom: 3rem;
    border-radius: 8px;
    overflow: hidden;
  }

  .article-image img {
    width: 100%;
    height: 400px;
    object-fit: cover;
  }

  .content-text h2 {
    color: #fff;
    font-size: 1.8rem;
    margin: 2.5rem 0 1.5rem;
    border-bottom: 2px solid #333;
    padding-bottom: 0.5rem;
  }

  .content-text p {
    line-height: 1.7;
    margin-bottom: 1.5rem;
    color: #b0b0b0;
  }

  .content-text ul {
    margin: 1.5rem 0;
    padding-left: 2rem;
  }

  .content-text li {
    margin-bottom: 0.5rem;
    color: #b0b0b0;
    line-height: 1.6;
  }

  .content-text blockquote {
    background-color: #0d0d0d;
    border-left: 4px solid #3b82f6;
    padding: 1.5rem 2rem;
    margin: 2rem 0;
    font-style: italic;
    color: #e0e0e0;
    border-radius: 0 8px 8px 0;
  }

  /* Sidebar */
  .article-sidebar {
    padding-top: 0;
  }

  .sidebar-widget {
    background-color: #1a1a1a;
    padding: 2rem;
    border-radius: 12px;
    margin-bottom: 2rem;
    border: 1px solid #333;
  }

  .sidebar-widget h3 {
    color: #fff;
    margin-bottom: 1.5rem;
    font-size: 1.2rem;
  }

  .toc-list {
    list-style: none;
    padding: 0;
  }

  .toc-list li {
    margin-bottom: 0.5rem;
  }

  .toc-list a {
    color: #b0b0b0;
    text-decoration: none;
    transition: color 0.3s ease;
  }

  .toc-list a:hover {
    color: #3b82f6;
  }

  .share-buttons {
    display: flex;
    flex-direction: column;
    gap: 0.75rem;
  }

  .share-button {
    display: block;
    padding: 0.75rem 1rem;
    border-radius: 8px;
    text-decoration: none;
    text-align: center;
    font-weight: 500;
    transition: all 0.3s ease;
  }

  .share-button.twitter {
    background-color: #1da1f2;
    color: white;
  }

  .share-button.linkedin {
    background-color: #0077b5;
    color: white;
  }

  .share-button.facebook {
    background-color: #1877f2;
    color: white;
  }

  .share-button:hover {
    transform: translateY(-2px);
    box-shadow: 0 4px 8px rgba(0, 0, 0, 0.3);
  }

  /* Related Articles */
  .related-articles {
    background-color: #0d0d0d;
    padding: 3rem 2rem;
    border-top: 1px solid #333;
  }

  .related-container {
    max-width: 1200px;
    margin: 0 auto;
  }

  .related-title {
    color: #fff;
    font-size: 2rem;
    margin-bottom: 2rem;
    text-align: center;
  }

  .related-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
    gap: 2rem;
  }

  .related-card {
    background-color: #1a1a1a;
    border-radius: 12px;
    overflow: hidden;
    border: 1px solid #333;
    transition: transform 0.3s ease, box-shadow 0.3s ease;
  }

  .related-card:hover {
    transform: translateY(-4px);
    box-shadow: 0 8px 25px rgba(0, 0, 0, 0.3);
  }

  .related-image {
    height: 180px;
    overflow: hidden;
  }

  .related-image img {
    width: 100%;
    height: 100%;
    object-fit: cover;
    transition: transform 0.3s ease;
  }

  .related-card:hover .related-image img {
    transform: scale(1.05);
  }

  .related-content {
    padding: 1.5rem;
  }

  .related-meta {
    display: flex;
    gap: 0.5rem;
    margin-bottom: 1rem;
    font-size: 0.85rem;
  }

  .related-tag {
    color: #3b82f6;
    font-weight: 600;
  }

  .related-date {
    color: #888;
  }

  .related-post-title {
    margin-bottom: 1rem;
  }

  .related-post-title a {
    color: #fff;
    text-decoration: none;
    font-size: 1.1rem;
    font-weight: 600;
    line-height: 1.3;
    transition: color 0.3s ease;
  }

  .related-post-title a:hover {
    color: #3b82f6;
  }

  .related-summary {
    color: #b0b0b0;
    line-height: 1.6;
    font-size: 0.9rem;
  }

  /* Article Navigation */
  .article-navigation {
    background-color: #1a1a1a;
    padding: 2rem;
    border-top: 1px solid #333;
  }

  .article-navigation .nav-container {
    max-width: 1200px;
    margin: 0 auto;
    display: flex;
    justify-content: space-between;
    align-items: center;
  }

  .nav-button {
    display: inline-block;
    padding: 0.75rem 1.5rem;
    background-color: #3b82f6;
    color: white;
    text-decoration: none;
    border-radius: 8px;
    font-weight: 500;
    transition: background-color 0.3s ease;
  }

  .nav-button:hover {
    background-color: #2563eb;
  }

  .nav-button.back-home {
    background-color: #333;
  }

  .nav-button.back-home:hover {
    background-color: #555;
  }

  /* Footer */
  .footer {
    background-color: #0d0d0d;
    border-top: 1px solid #333;
    padding: 3rem 2rem 1rem;
  }

  .footer-container {
    max-width: 1200px;
    margin: 0 auto;
  }

  .footer-content {
    display: grid;
    grid-template-columns: 1fr 2fr;
    gap: 3rem;
    margin-bottom: 2rem;
  }

  .footer-brand h3 {
    color: #fff;
    margin-bottom: 1rem;
  }

  .footer-brand p {
    color: #b0b0b0;
    line-height: 1.6;
  }

  .footer-links {
    display: grid;
    grid-template-columns: repeat(3, 1fr);
    gap: 2rem;
  }

  .link-group h4 {
    color: #fff;
    margin-bottom: 1rem;
  }

  .link-group a {
    display: block;
    color: #b0b0b0;
    text-decoration: none;
    margin-bottom: 0.5rem;
    transition: color 0.3s ease;
  }

  .link-group a:hover {
    color: #3b82f6;
  }

  .footer-bottom {
    border-top: 1px solid #333;
    padding-top: 2rem;
    text-align: center;
  }

  .footer-bottom p {
    color: #666;
    margin: 0;
  }

  /* Responsive Design */
  @media (max-width: 1024px) {
    .article-container {
      grid-template-columns: 1fr;
      gap: 2rem;
    }
  }

  @media (max-width: 768px) {
    .article-title {
      font-size: 2rem;
    }

    .article-body {
      padding: 2rem;
    }

    .article-navigation .nav-container {
      flex-direction: column;
      gap: 1rem;
    }

    .footer-content {
      grid-template-columns: 1fr;
      gap: 2rem;
    }

    .footer-links {
      grid-template-columns: 1fr;
      gap: 1.5rem;
    }

    .nav-links {
      gap: 1rem;
    }

    .nav-container {
      padding: 0 1rem;
    }
  }
</style>
